<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Profile Viewer - Week 14 Example</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f0f2f5; }
        .profile-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .profile-header {
            background: linear-gradient(135deg, #607d8b, #455a64);
            padding: 30px;
            text-align: center;
            color: white;
        }
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }
        .stat-card {
            text-align: center;
            padding: 15px;
        }
        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #607d8b;
        }
        .stat-label {
            font-size: 0.85rem;
            color: #999;
            text-transform: uppercase;
        }
        .repo-card {
            border-left: 4px solid #607d8b;
            transition: transform 0.2s;
        }
        .repo-card:hover {
            transform: translateX(5px);
        }
        .lang-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        #searchForm {
            max-width: 500px;
            margin: 0 auto;
        }
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 40px;
        }
        .error-message {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <p><a href="index.html">&larr; Back to Examples</a></p>

        <div class="text-center mb-5">
            <h1 style="color: #607d8b;">GitHub Profile Viewer</h1>
            <p class="text-muted">Search for any GitHub user and view their profile and repositories</p>
        </div>

        <!-- Search Form -->
        <form id="searchForm" class="mb-5" onsubmit="searchUser(event)">
            <div class="input-group input-group-lg">
                <span class="input-group-text bg-dark text-white">@</span>
                <input type="text" id="username" class="form-control" placeholder="Enter GitHub username" value="octocat" required>
                <button type="submit" class="btn btn-dark">Search</button>
            </div>
            <div class="text-center mt-2">
                <small class="text-muted">Try: octocat, torvalds, gaearon, addyosmani</small>
            </div>
        </form>

        <!-- Loading Spinner -->
        <div class="loading-spinner" id="loading">
            <div class="spinner-border text-secondary" style="width: 3rem; height: 3rem;"></div>
            <p class="mt-3 text-muted">Fetching profile...</p>
        </div>

        <!-- Error Message -->
        <div class="alert alert-danger error-message" id="errorMessage">
            <strong>Error!</strong> <span id="errorText"></span>
        </div>

        <!-- Profile Content -->
        <div id="profileContent" style="display: none;">
            <!-- Profile Card -->
            <div class="row justify-content-center mb-4">
                <div class="col-md-8">
                    <div class="profile-card">
                        <div class="profile-header">
                            <img id="avatar" src="" alt="Avatar" class="profile-avatar mb-3">
                            <h2 id="name" class="mb-1"></h2>
                            <p id="login" class="opacity-75 mb-2"></p>
                            <p id="bio" class="mb-0"></p>
                        </div>
                        <div class="row g-0">
                            <div class="col-4 stat-card border-end">
                                <div class="stat-number" id="repos">0</div>
                                <div class="stat-label">Repositories</div>
                            </div>
                            <div class="col-4 stat-card border-end">
                                <div class="stat-number" id="followers">0</div>
                                <div class="stat-label">Followers</div>
                            </div>
                            <div class="col-4 stat-card">
                                <div class="stat-number" id="following">0</div>
                                <div class="stat-label">Following</div>
                            </div>
                        </div>
                        <div class="p-3">
                            <div class="row text-muted small">
                                <div class="col-md-4" id="locationInfo" style="display:none;">
                                    <strong>Location:</strong> <span id="location"></span>
                                </div>
                                <div class="col-md-4" id="companyInfo" style="display:none;">
                                    <strong>Company:</strong> <span id="company"></span>
                                </div>
                                <div class="col-md-4">
                                    <strong>Joined:</strong> <span id="joined"></span>
                                </div>
                            </div>
                            <div class="text-center mt-3">
                                <a id="profileLink" href="#" target="_blank" class="btn btn-outline-dark btn-sm">
                                    View on GitHub
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Repositories -->
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <h3 class="mb-3" style="color: #607d8b;">
                        Recent Repositories
                        <small class="text-muted" id="repoCount"></small>
                    </h3>
                    <div id="repoList"></div>
                </div>
            </div>
        </div>

        <!-- Code Explanation -->
        <div class="row justify-content-center mt-5">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header bg-dark text-white">
                        <strong>How This Works - Source Code</strong>
                    </div>
                    <div class="card-body">
                        <pre class="bg-light p-3 rounded" style="font-size: 0.85rem;"><code>// GitHub API is public and doesn't require authentication for basic requests
const GITHUB_API = 'https://api.github.com';

// 1. Fetch user profile
async function fetchUser(username) {
    const response = await fetch(`${GITHUB_API}/users/${username}`);
    if (!response.ok) throw new Error('User not found');
    return response.json();
}

// 2. Fetch user repositories (sorted by recently updated)
async function fetchRepos(username) {
    const response = await fetch(
        `${GITHUB_API}/users/${username}/repos?sort=updated&per_page=6`
    );
    return response.json();
}

// 3. Display the data in the UI
async function searchUser(username) {
    try {
        showLoading();
        const [user, repos] = await Promise.all([
            fetchUser(username),
            fetchRepos(username)
        ]);
        displayProfile(user);
        displayRepos(repos);
    } catch (error) {
        showError(error.message);
    }
}

// Note: Promise.all() fetches user AND repos in parallel for speed!</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <hr class="mt-5">
        <p><a href="index.html">&larr; Back to Examples</a></p>
    </div>

    <script>
        const GITHUB_API = 'https://api.github.com';

        const languageColors = {
            'JavaScript': '#f1e05a', 'TypeScript': '#3178c6', 'Python': '#3572A5',
            'Java': '#b07219', 'C++': '#f34b7d', 'C': '#555555', 'HTML': '#e34c26',
            'CSS': '#563d7c', 'Ruby': '#701516', 'Go': '#00ADD8', 'Rust': '#dea584',
            'PHP': '#4F5D95', 'Swift': '#F05138', 'Kotlin': '#A97BFF', 'Shell': '#89e051',
            'C#': '#178600', 'Dart': '#00B4AB'
        };

        async function searchUser(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            if (!username) return;

            showLoading();
            hideError();
            hideProfile();

            try {
                const [user, repos] = await Promise.all([
                    fetchUser(username),
                    fetchRepos(username)
                ]);

                displayProfile(user);
                displayRepos(repos);
            } catch (error) {
                showError(error.message);
            }

            hideLoading();
        }

        async function fetchUser(username) {
            const response = await fetch(`${GITHUB_API}/users/${username}`);
            if (response.status === 404) throw new Error(`User "${username}" not found on GitHub.`);
            if (response.status === 403) throw new Error('API rate limit exceeded. Try again in a minute.');
            if (!response.ok) throw new Error(`HTTP error ${response.status}`);
            return response.json();
        }

        async function fetchRepos(username) {
            const response = await fetch(`${GITHUB_API}/users/${username}/repos?sort=updated&per_page=6`);
            if (!response.ok) return [];
            return response.json();
        }

        function displayProfile(user) {
            document.getElementById('avatar').src = user.avatar_url;
            document.getElementById('name').textContent = user.name || user.login;
            document.getElementById('login').textContent = `@${user.login}`;
            document.getElementById('bio').textContent = user.bio || 'No bio available';
            document.getElementById('repos').textContent = user.public_repos;
            document.getElementById('followers').textContent = user.followers;
            document.getElementById('following').textContent = user.following;
            document.getElementById('profileLink').href = user.html_url;
            document.getElementById('joined').textContent = new Date(user.created_at).toLocaleDateString('en-US', { year: 'numeric', month: 'long' });

            if (user.location) {
                document.getElementById('location').textContent = user.location;
                document.getElementById('locationInfo').style.display = '';
            } else {
                document.getElementById('locationInfo').style.display = 'none';
            }

            if (user.company) {
                document.getElementById('company').textContent = user.company;
                document.getElementById('companyInfo').style.display = '';
            } else {
                document.getElementById('companyInfo').style.display = 'none';
            }

            document.getElementById('profileContent').style.display = '';
        }

        function displayRepos(repos) {
            const repoList = document.getElementById('repoList');
            document.getElementById('repoCount').textContent = `(showing ${repos.length})`;

            if (repos.length === 0) {
                repoList.innerHTML = '<p class="text-muted">No public repositories found.</p>';
                return;
            }

            repoList.innerHTML = repos.map(repo => {
                const langColor = languageColors[repo.language] || '#ccc';
                return `
                <div class="card repo-card mb-3">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h5 class="mb-1">
                                    <a href="${repo.html_url}" target="_blank" class="text-decoration-none" style="color: #607d8b;">
                                        ${repo.name}
                                    </a>
                                </h5>
                                <p class="text-muted mb-2">${repo.description || 'No description'}</p>
                                <div class="d-flex gap-3 text-muted small">
                                    ${repo.language ? `<span><span class="lang-dot" style="background:${langColor}"></span>${repo.language}</span>` : ''}
                                    <span>&#9733; ${repo.stargazers_count}</span>
                                    <span>&#128276; ${repo.forks_count}</span>
                                    <span>Updated ${timeAgo(repo.updated_at)}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        function timeAgo(dateString) {
            const seconds = Math.floor((new Date() - new Date(dateString)) / 1000);
            const intervals = { year: 31536000, month: 2592000, week: 604800, day: 86400, hour: 3600 };
            for (const [unit, secs] of Object.entries(intervals)) {
                const interval = Math.floor(seconds / secs);
                if (interval >= 1) return `${interval} ${unit}${interval > 1 ? 's' : ''} ago`;
            }
            return 'just now';
        }

        function showLoading() { document.getElementById('loading').style.display = ''; }
        function hideLoading() { document.getElementById('loading').style.display = 'none'; }
        function showError(msg) {
            document.getElementById('errorText').textContent = msg;
            document.getElementById('errorMessage').style.display = '';
        }
        function hideError() { document.getElementById('errorMessage').style.display = 'none'; }
        function hideProfile() { document.getElementById('profileContent').style.display = 'none'; }
    </script>
</body>
</html>
